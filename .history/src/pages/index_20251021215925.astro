---
import { getSheetData } from "../lib/getSheetData.ts";
import FolderStack from "../components/FolderStack.jsx";

const data = await getSheetData();

// Group by Topic
const grouped = Object.values(
  data.reduce((acc, item) => {
    if (!acc[item.Topic]) {
      acc[item.Topic] = {
        topic: item.Topic,
        name: item.name,
        learnerCategory: item.learnerCategory,
        description: item.description,
        audience: item.audience,
        "OSPO Relevance": item["OSPO Relevance"],
        url: item.url,
      };
    }
    return acc;
  }, {})
);
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>OSPO Folders</title>
  </head>
  <body class="bg-[#1E1E1E] text-white font-sans min-h-screen p-10">
    <h1 class="text-2xl font-bold mb-6">OSPO Learning Folders</h1>
    <FolderStack topics={grouped} client:load />
  </body>
</html>