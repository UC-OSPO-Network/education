---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getSheetData } from '../lib/getSheetData.ts';
import Folder from '../components/Folder.jsx';

const rows = await getSheetData();

// Group posts by learnerCategory
const grouped = rows.reduce((acc, row) => {
  const category = row.learnerCategory || "Uncategorized";
  acc[category] = acc[category] || [];
  acc[category].push(row);
  return acc;
}, {});
---

<BaseLayout title="Home">
  <h1 style="margin-bottom:2rem; font-size:2.5rem; font-weight:700; color:#FFFFFF;">Latest Lessons</h1>

  {Object.entries(grouped).map(([category, posts]) => (
    <Folder client:load category={category} posts={posts} />
  ))}
</BaseLayout>