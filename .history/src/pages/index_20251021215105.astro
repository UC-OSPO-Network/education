---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getSheetData } from '../lib/getSheetData.js';

const rows = await getSheetData();
---

<BaseLayout title="Home">
  <h1 style="margin-bottom:2rem; font-size:2.5rem; font-weight:700; color:#015581;">Latest Lessons</h1>

  {rows.length === 0 ? (
    <p>No data found.</p>
  ) : (
    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap:2rem;">
      {rows.map(row => (
        <a href={row.url} target="_blank" style="text-decoration:none; color:inherit;">
          <div style="
            border:1px solid #e0e0e0;
            border-radius:16px;
            padding:2rem;
            box-shadow:0 8px 20px rgba(0,0,0,0.05);
            background-color:#fff;
            display:flex;
            flex-direction:column;
            justify-content:space-between;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
          "
          onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 12px 24px rgba(0,0,0,0.08)'"
          onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.05)'"
          >
            <h2 style="margin:0 0 0.5rem 0; font-size:1.75rem; font-weight:700; color:#015581;">{row.name || 'No Name'}</h2>
            <h4 style="margin:0 0 1rem 0; font-weight:500; color:#555;">{row.learnerCategory || 'No Category'}</h4>
            <h5 style="margin:0 0 0.75rem 0; font-weight:500; color:#333;">Topic: {row.Topic || 'No Topic'}</h5>
            <p style="margin:0 0 1.5rem 0; color:#333; font-size:0.95rem; line-height:1.5;">{row.description || 'No Description'}</p>
            <div style="display:flex; justify-content:space-between; font-size:0.85rem; color:#777; border-top:1px solid #f0f0f0; padding-top:0.5rem;">
              <span>Audience: {row.audience || 'N/A'}</span>
              <span>OSPO Relevance: {row['OSPO Relevance'] || 'N/A'}</span>
            </div>
          </div>
        </a>
      ))}
    </div>
  )}
</BaseLayout>